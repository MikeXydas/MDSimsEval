

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. RMSF Baseline Models &mdash; MDSimsEval 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. PCA Analysis" href="PcaAnalysis.html" />
    <link rel="prev" title="5. RMSF Analysis" href="RmsfAnalysis.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MDSimsEval
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Prerequisites.html">1. Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadingData.html">2. Reading the simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="AnalysisActor.html">3. AnalysisActor</a></li>
<li class="toctree-l1"><a class="reference internal" href="RgSasaAnalysis.html">4. Rg and SASA Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="RmsfAnalysis.html">5. RMSF Analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. RMSF Baseline Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="PcaAnalysis.html">7. PCA Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Utils.html">8. Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Basic Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDSimsEval</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">6. </span>RMSF Baseline Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pages/RMSFBaselineModels.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rmsf-baseline-models">
<h1><span class="section-number">6. </span>RMSF Baseline Models<a class="headerlink" href="#rmsf-baseline-models" title="Permalink to this headline">¶</a></h1>
<p>On this package we are focusing a lot on the RMSF value as a mean of selecting which residues have the most
separability between the Agonist - Antagonist classes. In order to evaluate our residue selection techniques we
need a way to quantify their separability.</p>
<p>For this reason we created some baseline models which are simple and can be used as any ML model (<code class="docutils literal notranslate"><span class="pre">fit</span></code>, <code class="docutils literal notranslate"><span class="pre">predict</span></code>)
and calculate values such as accuracy.</p>
<p>In the module we have an abstract base class called <code class="docutils literal notranslate"><span class="pre">BaselineClassifier</span></code> which contains some basic helper methods
for reading and preparing the RMSF values. Any subclass must implement the <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code> methods.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/baseline_structure.png"><img alt="baseline uml diagram missing" src="../_images/baseline_structure.png" style="width: 500px; height: 250px;" /></a>
</div>
<p>We suggest reading  <a class="reference internal" href="Examples.html#rmsf-baseline-models"><span class="std std-ref">this example</span></a> to feel familiar with the flow.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These models should not be used as the final classification models due to their simplicity. Their goal is
evaluate the residue selection techniques.</p>
</div>
<p>The module also includes a method for bootstrapping the dataset of ligands.</p>
<span class="target" id="module-MDSimsEval.rmsf_baseline_models"></span><dl class="py class">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues">
<em class="property">class </em><code class="sig-prename descclassname">MDSimsEval.rmsf_baseline_models.</code><code class="sig-name descname">AggregatedResidues</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">stop</em>, <em class="sig-param">rmsf_cache</em>, <em class="sig-param">method=&lt;function mean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues" title="Permalink to this definition">¶</a></dt>
<dd><p>This simple model fits on the training data by calculating the average RMSF value of the agonist and the
antagonist sets. The RMSF is calculated on the residues given and aggregated to one value. This means that for
the agonists we calculate the average/median value for each residue and then we aggregate again ending with a
scalar value.</p>
<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues.start">
<code class="sig-name descname">start</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues.start" title="Permalink to this definition">¶</a></dt>
<dd><p>The starting frame of the window</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues.stop">
<code class="sig-name descname">stop</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>The last frame of the window</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues.method">
<code class="sig-name descname">method</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that we will use for summarizing each residue, eg <cite>np.mean</cite>, <cite>np.median</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>func</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues.agonist_baseline">
<code class="sig-name descname">agonist_baseline</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues.agonist_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>The aggregated RMSF value of the agonist class</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues.antagonist_baseline">
<code class="sig-name descname">antagonist_baseline</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues.antagonist_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>The aggregated RMSF value of the antagonist class</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues.selected_residues">
<code class="sig-name descname">selected_residues</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues.selected_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of size total_residues, where True on the indexes of the residue ids
selected</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List[boolean]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">train_analysis_actors</span></em>, <em class="sig-param"><span class="n">residues</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that initializes the aggregated RMSF value for each class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_analysis_actors</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>residues</strong> – <p>A list of residue ids that the model will use. For all the residues give <code class="docutils literal notranslate"><span class="pre">np.arange(290)</span></code> . Can
also be a dictionary with residue ids as keys and values a list of <code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">stop]</span></code>. This
argument allows us to use a residue in more than one window. This is used in the residue cherry
picking part of the thesis.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will use the window saved as an attribute when we created the model object</span>
<span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">83</span><span class="p">]</span>
<span class="ow">or</span>
<span class="n">residues</span> <span class="o">=</span> <span class="p">{</span>
             <span class="mi">115</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">117</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">81</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">78</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">],</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]],</span>
             <span class="mi">254</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]],</span>
          <span class="p">}</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="MDSimsEval.rmsf_baseline_models.AggregatedResidues.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ligand</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.AggregatedResidues.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the distance of the unknown ligand from the agonist and antagonist averages and returns
as a label the class that is closest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ligand</strong> (<em>AnalysisActorClass</em>) – The ligand we want to predict its class</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The class label, 1 for Agonist, 0 for Antagonist.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="MDSimsEval.rmsf_baseline_models.BaselineClassifier">
<em class="property">class </em><code class="sig-prename descclassname">MDSimsEval.rmsf_baseline_models.</code><code class="sig-name descname">BaselineClassifier</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">stop</em>, <em class="sig-param">rmsf_cache</em>, <em class="sig-param">method=&lt;function mean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.BaselineClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>An abstract class that the baseline classifiers models extend from. The subclasses must implement the abstract
methods <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code>.</p>
<p>The class provides some helper methods in order to stack the RMSF of the selected residues for training and
getting the RMSF of the unknown ligand we want to predict its class.</p>
<p>If you want to extend the method we suggest reading the other classes in this model. This will help in order
to better understand how <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code> are implemented and how we use the helper methods in this class.</p>
</dd></dl>

<dl class="py class">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance">
<em class="property">class </em><code class="sig-prename descclassname">MDSimsEval.rmsf_baseline_models.</code><code class="sig-name descname">KSDistance</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">stop</em>, <em class="sig-param">rmsf_cache</em>, <em class="sig-param">method=&lt;function mean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for evaluating residue selections based on their RMSF.</p>
<p>We calculate for each class the average/median RMSF of each residue. Then when we receive an unknown ligand
we use the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ks_2samp.html">k-s test</a>
which returns the “distance” of the distributions of the unknown ligand and the class. We calculate the distance
for the other class too and classify on the class with the smallest distance.</p>
<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance.start">
<code class="sig-name descname">start</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance.start" title="Permalink to this definition">¶</a></dt>
<dd><p>The starting frame of the window</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance.stop">
<code class="sig-name descname">stop</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>The last frame of the window</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance.method">
<code class="sig-name descname">method</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that we will use for summarizing each residue, eg <code class="docutils literal notranslate"><span class="pre">np.mean</span></code>, <code class="docutils literal notranslate"><span class="pre">np.median</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>func</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance.agonist_residue_baseline">
<code class="sig-name descname">agonist_residue_baseline</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance.agonist_residue_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the aggregated RMSF value of the agonists of each residue</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance.antagonist_residue_baseline">
<code class="sig-name descname">antagonist_residue_baseline</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance.antagonist_residue_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the aggregated RMSF value of the antagonists of each
residue</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance.selected_residues">
<code class="sig-name descname">selected_residues</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance.selected_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of size total_residues, where True on the indexes of the residue ids
selected</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List[boolean]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">train_analysis_actors</span></em>, <em class="sig-param"><span class="n">residues</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that initializes the aggregated RMSF value for each residue for each class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_analysis_actors</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>residues</strong> – <p>A list of residue ids that the model will use. For all the residues give
<code class="docutils literal notranslate"><span class="pre">np.arange(290)</span></code> . Can also be a dictionary with residue ids as keys and values a
list of <code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">stop]</span></code>. This argument allows us to use a residue in more than
one window. This is used in the residue cherry picking part of the thesis.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will use the window saved as an attribute when we created the model object</span>
<span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">83</span><span class="p">]</span>
<span class="ow">or</span>
<span class="n">residues</span> <span class="o">=</span> <span class="p">{</span>
             <span class="mi">115</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">117</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">81</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">78</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">],</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]],</span>
             <span class="mi">254</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]],</span>
          <span class="p">}</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="MDSimsEval.rmsf_baseline_models.KSDistance.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ligand</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.KSDistance.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the majority voting and returns the predicted class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ligand</strong> (<em>AnalysisActorClass</em>) – The ligand we want to predict its class</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The class label, 1 for Agonist, 0 for Antagonist.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority">
<em class="property">class </em><code class="sig-prename descclassname">MDSimsEval.rmsf_baseline_models.</code><code class="sig-name descname">ResidueMajority</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">stop</em>, <em class="sig-param">rmsf_cache</em>, <em class="sig-param">method=&lt;function mean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority" title="Permalink to this definition">¶</a></dt>
<dd><p>Used for evaluating residue selections based on their RMSF.</p>
<p>This is a simple baseline model able to quantify how good our residue selection is.
Given a k - k training set of agonists - antagonists,for an unknown ligand
we iterate through the residues. If the residue is closer to the median/average of the
training agonists (of the RMSF values of the specific residue) then the residue votes that
the ligand is an agonist. Else it votes that the ligand is an antagonist.
|
| At then end we see which class had the most votes.</p>
<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority.start">
<code class="sig-name descname">start</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority.start" title="Permalink to this definition">¶</a></dt>
<dd><p>The starting frame of the window</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority.stop">
<code class="sig-name descname">stop</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>The last frame of the window</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority.method">
<code class="sig-name descname">method</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that we will use for summarizing each residue, eg <code class="docutils literal notranslate"><span class="pre">np.mean</span></code>, <code class="docutils literal notranslate"><span class="pre">np.median</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>func</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority.agonist_residue_baseline">
<code class="sig-name descname">agonist_residue_baseline</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority.agonist_residue_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the aggregated RMSF value of the agonists of each residue</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority.antagonist_residue_baseline">
<code class="sig-name descname">antagonist_residue_baseline</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority.antagonist_residue_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the aggregated RMSF value of the antagonists of each
residue</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority.selected_residues">
<code class="sig-name descname">selected_residues</code><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority.selected_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of size total_residues, where True on the indexes of the residue ids
selected</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List[boolean]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">train_analysis_actors</span></em>, <em class="sig-param"><span class="n">residues</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>The function that initializes the aggregated RMSF value for each residue for each class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_analysis_actors</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>residues</strong> – <p>A list of residue ids that the model will use. For all the residues give
<code class="docutils literal notranslate"><span class="pre">np.arange(290)</span></code> . Can also be a dictionary with residue ids as keys and values a
list of <code class="docutils literal notranslate"><span class="pre">[start,</span> <span class="pre">stop]</span></code>. This argument allows us to use a residue in more than
one window. This is used in the residue cherry picking part of the thesis.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will use the window saved as an attribute when we created the model object</span>
<span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">83</span><span class="p">]</span>
<span class="ow">or</span>
<span class="n">residues</span> <span class="o">=</span> <span class="p">{</span>
             <span class="mi">115</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">117</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">81</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]],</span>
             <span class="mi">78</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">],</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]],</span>
             <span class="mi">254</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]],</span>
          <span class="p">}</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="MDSimsEval.rmsf_baseline_models.ResidueMajority.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ligand</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.ResidueMajority.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the majority voting and returns the predicted class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ligand</strong> (<em>AnalysisActorClass</em>) – The ligand we want to predict its class</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The class label, 1 for Agonist, 0 for Antagonist.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_baseline_models.bootstrap_dataset">
<code class="sig-prename descclassname">MDSimsEval.rmsf_baseline_models.</code><code class="sig-name descname">bootstrap_dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">samples</span></em>, <em class="sig-param"><span class="n">sample_size</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_baseline_models.bootstrap_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a given number of bootstrapped samples of the Agonist - Antagonist dataset.
| Also the remaining ligands are returned as a validation set.
| Eg if sample_size = 20 and on each class we have 27 ligands, then we create
a dict of 20 - 20 unique ligands and the remaining 7 ligands are returned as a validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>samples</strong> (<em>int</em>) – Number of bootstrapped samples generated</p></li>
<li><p><strong>sample_size</strong> (<em>int</em>) – How many ligands of each class the training set will have</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (<code class="docutils literal notranslate"><span class="pre">train_dicts</span></code>, <code class="docutils literal notranslate"><span class="pre">test_dicts</span></code>)</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="PcaAnalysis.html" class="btn btn-neutral float-right" title="7. PCA Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="RmsfAnalysis.html" class="btn btn-neutral float-left" title="5. RMSF Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Mike Xydas

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>