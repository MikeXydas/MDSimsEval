

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. RMSF Analysis &mdash; MDSimsEval 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. RMSF Baseline Models" href="RMSFBaselineModels.html" />
    <link rel="prev" title="4. Rg and SASA Analysis" href="RgSasaAnalysis.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MDSimsEval
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Prerequisites.html">1. Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReadingData.html">2. Reading the simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="AnalysisActor.html">3. AnalysisActor</a></li>
<li class="toctree-l1"><a class="reference internal" href="RgSasaAnalysis.html">4. Rg and SASA Analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. RMSF Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#top-and-high-rmsf-analysis">5.1. Top and High RMSF Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bootstrapped-rmsf-analysis">5.2. Bootstrapped RMSF Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="RMSFBaselineModels.html">6. RMSF Baseline Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="PcaAnalysis.html">7. PCA Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Utils.html">8. Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Basic Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDSimsEval</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>RMSF Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pages/RmsfAnalysis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rmsf-analysis">
<h1><span class="section-number">5. </span>RMSF Analysis<a class="headerlink" href="#rmsf-analysis" title="Permalink to this headline">¶</a></h1>
<p>RMSF is a measure of the deviation of the position of a particle i with respect to a reference position <strong>over time</strong>.</p>
<p><strong>Difference between RMSD and RMSF</strong>: The latter is averaged over time, giving a value for each particle i. For the
RMSD the average is taken over the particles, giving time specific values. So <strong>RMSD is time specific</strong> and <strong>RMSF
is atom specific</strong> <a class="reference external" href="http://www.drugdesign.gr/uploads/7/6/0/2/7602318/lecture_mdanalysis.pdf">(ref)</a>.</p>
<p>This module aims on finding which are <strong>the most differentiating residues of the two classes based on their RMSF</strong>.
To achieve that I followed two paths:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#top-high-rmsf-analysis"><span class="std std-ref">Top and High RMSF Analysis</span></a>, which is a more simplistic and prone to overfitting approach</p></li>
<li><p><a class="reference internal" href="#bootstrapped-rmsf-analysis"><span class="std std-ref">Bootstrapped RMSF Analysis</span></a> (<em>recommended</em>), which is more complex and time consuming but more robust to the results it gives</p></li>
</ul>
<div class="section" id="top-and-high-rmsf-analysis">
<span id="top-high-rmsf-analysis"></span><h2><span class="section-number">5.1. </span>Top and High RMSF Analysis<a class="headerlink" href="#top-and-high-rmsf-analysis" title="Permalink to this headline">¶</a></h2>
<p>We define as <strong>High-k</strong>, the k residues that had the highest RMSF on their respective class. This creates two
lists of residues, one for each class.</p>
<p>We define as <strong>Top-k</strong>, the k residues that had the biggest <code class="docutils literal notranslate"><span class="pre">abs(high_k_class1</span> <span class="pre">-</span> <span class="pre">high_k_class2)</span></code>.</p>
<span class="target" id="module-MDSimsEval.rmsf_analysis"></span><dl class="py function">
<dt id="MDSimsEval.rmsf_analysis.corr_matrix">
<code class="sig-prename descclassname">MDSimsEval.rmsf_analysis.</code><code class="sig-name descname">corr_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'pearson'</span></em>, <em class="sig-param"><span class="n">top</span><span class="o">=</span><span class="default_value">290</span></em>, <em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">2500</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_analysis.corr_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a correlation matrix of the RMSF which has <code class="docutils literal notranslate"><span class="pre">#agonists</span> <span class="pre">+</span> <span class="pre">#antagonists</span> <span class="pre">x</span> <span class="pre">#agonists</span> <span class="pre">+</span> <span class="pre">#antagonists</span></code> dimensions.
The correlation values are calculated on the RMSF values of the <code class="docutils literal notranslate"><span class="pre">top-k</span></code> residues. On the output DataFrame the ligand
names have only their first 5 characters for visual reasons.</p>
<p>The result is not in a readable format and could be passed in <code class="docutils literal notranslate"><span class="pre">MDSimsEval.utils.render_corr_df</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method should be deleted / refactored. I suggest using
<code class="docutils literal notranslate"><span class="pre">MDSimsEval.rmsf_bootstrapped_analysis.create_correlation_df</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>method</strong> (<em>str</em>) – pearson, kendall, spearman</p></li>
<li><p><strong>top</strong> (<em>int</em>) – The top-k residues that will be used for the correlation calculations</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> which has the pair correlations of all the ligands</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_analysis.create_bar_plots_avg_stde">
<code class="sig-prename descclassname">MDSimsEval.rmsf_analysis.</code><code class="sig-name descname">create_bar_plots_avg_stde</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">dir_path</span></em>, <em class="sig-param"><span class="n">top</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">2500</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_analysis.create_bar_plots_avg_stde" title="Permalink to this definition">¶</a></dt>
<dd><p>The method will create two plots (one for the agonists and one for the antagonists). The plot will have the
avg rmsf per residue and the standard error of the mean. The color of the bars of the top-k
<code class="docutils literal notranslate"><span class="pre">|agon_rmsf_avg</span> <span class="pre">-</span> <span class="pre">antagon_rmsf_avg|</span></code> RMSF residues are plotted in a different color
so as to be easily distinguished.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../_images/rmsf_barplots.png"><img alt="rmsf corr figure missing" src="../_images/rmsf_barplots.png" style="width: 550px; height: 500px;" /></a>
<p class="caption"><span class="caption-text">Barplots of average RMSF per residue, click for higher resolution.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>dir_path</strong> (<em>str</em>) – The path of the directory the plot will be saved (must end with a <code class="docutils literal notranslate"><span class="pre">/</span></code>)</p></li>
<li><p><strong>top</strong> (<em>int</em>) – The top-k residues that will be plotted with a different color</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_analysis.find_high_k">
<code class="sig-prename descclassname">MDSimsEval.rmsf_analysis.</code><code class="sig-name descname">find_high_k</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">2500</span></em>, <em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">rmsf_cache</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_analysis.find_high_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns two DataFrames for each class with the residues that had the highest average RMSF on the specified window.</p>
<blockquote>
<div><dl>
<dt>Example:</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">MDSimsEval.utils</span> <span class="kn">import</span> <span class="n">create_analysis_actor_dict</span>
<span class="kn">from</span> <span class="nn">MDSimsEval.rmsf_analysis</span> <span class="kn">import</span> <span class="n">find_high_k</span>

<span class="n">analysis_actors_dict</span> <span class="o">=</span> <span class="n">create_analysis_actor_dict</span><span class="p">(</span><span class="s1">&#39;/path_to_dataset/&#39;</span><span class="p">)</span> <span class="c1"># Read Agonists/Antagonists</span>

<span class="n">agon_df</span><span class="p">,</span> <span class="n">antagon_df</span> <span class="o">=</span> <span class="n">find_high_k</span><span class="p">(</span><span class="n">analysis_actors_dict</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Printing the DataFrame of the residues that had the highest average RMSF across the agonists</span>
<span class="nb">print</span><span class="p">(</span><span class="n">agon_df</span><span class="p">)</span>
    <span class="n">ResidueId</span>     <span class="n">RMSF</span> <span class="n">Res</span> <span class="n">Name</span>
<span class="mi">0</span>       <span class="mf">116.0</span>  <span class="mf">3.63539</span>      <span class="n">ARG</span>
<span class="mi">1</span>       <span class="mf">117.0</span>  <span class="mf">3.31561</span>      <span class="n">PHE</span>
<span class="mi">2</span>         <span class="mf">0.0</span>  <span class="mf">3.01161</span>      <span class="n">THR</span>
<span class="mi">3</span>       <span class="mf">200.0</span>  <span class="mf">2.86724</span>      <span class="n">ARG</span>
<span class="mi">4</span>       <span class="mf">199.0</span>  <span class="mf">2.84393</span>      <span class="n">CYS</span>
<span class="mi">5</span>       <span class="mf">114.0</span>  <span class="mf">2.78910</span>      <span class="n">HIE</span>
<span class="mi">6</span>         <span class="mf">1.0</span>  <span class="mf">2.78634</span>      <span class="n">HIE</span>
<span class="mi">7</span>       <span class="mf">198.0</span>  <span class="mf">2.76465</span>      <span class="n">LEU</span>
<span class="mi">8</span>         <span class="mf">2.0</span>  <span class="mf">2.47342</span>      <span class="n">LEU</span>
<span class="mi">9</span>       <span class="mf">203.0</span>  <span class="mf">2.44867</span>      <span class="n">GLN</span>
<span class="mi">10</span>      <span class="mf">115.0</span>  <span class="mf">2.41584</span>      <span class="n">SER</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
<li><p><strong>k</strong> (<em>int</em>) – The number of the top residues that will be included in the returned DataFrame</p></li>
<li><p><strong>rmsf_cache</strong> – Dictionary with key <code class="docutils literal notranslate"><span class="pre">ligand_name_start_stop</span></code> and value the RMSF run result. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>
no cache will be kept</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of 2 <code class="docutils literal notranslate"><span class="pre">pd.DataFrame['ResidueId',</span> <span class="pre">'RMSF',</span> <span class="pre">'Res</span> <span class="pre">Name']</span></code> of the high-k residues, where on <code class="docutils literal notranslate"><span class="pre">RMSF</span></code>
column we have the residues with the highest average RMSF. The first DataFrame is for the 1st class (in our
case Agonists and the second one for the 2nd class (in our case Antagonists).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_analysis.find_top_k">
<code class="sig-prename descclassname">MDSimsEval.rmsf_analysis.</code><code class="sig-name descname">find_top_k</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">2500</span></em>, <em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">rmsf_cache</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_analysis.find_top_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a DataFrame with the residues that had the biggest absolute difference between agonists and antagonists
on their average RMSF [<code class="docutils literal notranslate"><span class="pre">abs(agon_avg_rmsf_per_residue</span> <span class="pre">-</span> <span class="pre">antagon_avg_rmsf_per_residue)</span></code>].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
<li><p><strong>k</strong> (<em>int</em>) – The number of the top residues that will be included in the returned DataFrame</p></li>
<li><p><strong>rmsf_cache</strong> – Dictionary with key <code class="docutils literal notranslate"><span class="pre">ligand_name_start_stop</span></code> and value the RMSF run result. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>
no cache will be kept</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">pd.DataFrame['ResidueId',</span> <span class="pre">'RMSF',</span> <span class="pre">'Res</span> <span class="pre">Name']</span></code> of the top-k residues, where on <code class="docutils literal notranslate"><span class="pre">RMSF</span></code> column we have
absolute difference.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_analysis.get_avg_rmsf_per_residue">
<code class="sig-prename descclassname">MDSimsEval.rmsf_analysis.</code><code class="sig-name descname">get_avg_rmsf_per_residue</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ligand</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_analysis.get_avg_rmsf_per_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Having the series of resnumbs eg [1, 1, 1, 2, 2, …, 290, 290] and their respective
RMSF create buckets (each bucket represents a residue) and calculate the average
RMSF of each residue</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ligand</strong> (<em>AnalysisActor.class</em>) – The AnalysisActor object on which we have calculated the RMSF</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The average RMSF of each residue</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray[#unique_resnumbs]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_analysis.reset_rmsf_calculations">
<code class="sig-prename descclassname">MDSimsEval.rmsf_analysis.</code><code class="sig-name descname">reset_rmsf_calculations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">start</span></em>, <em class="sig-param"><span class="n">stop</span></em>, <em class="sig-param"><span class="n">cache</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_analysis.reset_rmsf_calculations" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the RMSF calculations of all the ligands in the <code class="docutils literal notranslate"><span class="pre">analysis_actors_dict</span></code> and recalculates them on the
given window.</p>
<p>This function could be part of the <code class="docutils literal notranslate"><span class="pre">AnalysisActor</span></code> class but in order to keep the class simple I have avoided it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
<li><p><strong>cache</strong> – Dictionary with key <code class="docutils literal notranslate"><span class="pre">ligand_name_start_stop</span></code> and value the RMSF run result. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code> no cache
will be kept</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_analysis.stat_test_residues">
<code class="sig-prename descclassname">MDSimsEval.rmsf_analysis.</code><code class="sig-name descname">stat_test_residues</code><span class="sig-paren">(</span><em class="sig-param">analysis_actors_dict</em>, <em class="sig-param">stat_test=&lt;function ttest_ind&gt;</em>, <em class="sig-param">threshold=0.05</em>, <em class="sig-param">start=-1</em>, <em class="sig-param">stop=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_analysis.stat_test_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the most differentiating residues based on a statistical test on their RMSF. If <code class="docutils literal notranslate"><span class="pre">start==-1</span></code> and <code class="docutils literal notranslate"><span class="pre">stop==-1</span></code>
then we do not recalculate RMSF on the given window.</p>
<div class="line-block">
<div class="line">For example on the T-test we have:</div>
<div class="line">Null Hypothesis: The RMSFs of a specific residue have identical average (expected) values</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>I suggest firstly using the <a class="reference internal" href="#bootstrapped-rmsf-analysis"><span class="std std-ref">Bootstrapped RMSF Analysis</span></a> which provides a more time consuming but also more
generalized way of finding the most significant residues.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – : <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>stat_test</strong> (<em>scipy.stats</em>) – A statistical test method with the interface of scipy.stats methods</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – The p-value threshold of the accepted and returned residues</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of tuples of the residue ids (0-indexed) that had below the threshold p-value, the p_value.
Eg <code class="docutils literal notranslate"><span class="pre">[(10,</span> <span class="pre">0.03),</span> <span class="pre">(5,</span> <span class="pre">0.042),</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="bootstrapped-rmsf-analysis">
<span id="id1"></span><h2><span class="section-number">5.2. </span>Bootstrapped RMSF Analysis<a class="headerlink" href="#bootstrapped-rmsf-analysis" title="Permalink to this headline">¶</a></h2>
<p>Bootstrapped RMSF analysis aims on finding the most significant residues which their RMSF helps us differentiate
our two classes. It differs from the <em>Top and High Analysis</em> above since it uses good data science practises to <strong>avoid
overfitting and providing with an evaluation of how general enough are our results</strong>.</p>
<p>More on the method used to achieve this can be found on <code class="docutils literal notranslate"><span class="pre">bootstrapped_residue_analysis</span></code> function below.</p>
<dl>
<dt>Example:</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">MDSimsEval.utils</span> <span class="kn">import</span> <span class="n">create_analysis_actor_dict</span>

<span class="kn">from</span> <span class="nn">MDSimsEval.rmsf_bootstrapped_analysis</span> <span class="kn">import</span> <span class="n">bootstrapped_residue_analysis</span>
<span class="kn">from</span> <span class="nn">MDSimsEval.rmsf_bootstrapped_analysis</span> <span class="kn">import</span> <span class="n">sensitivity_calc</span>

<span class="n">analysis_actors_dict</span> <span class="o">=</span> <span class="n">create_analysis_actor_dict</span><span class="p">(</span><span class="s1">&#39;path_to_data_directory/&#39;</span><span class="p">)</span>

<span class="c1"># Find the most significant residues per iteration</span>
<span class="n">significant_res_per_iter</span> <span class="o">=</span> <span class="n">bootstrapped_residue_analysis</span><span class="p">(</span><span class="n">analysis_actors_dict</span><span class="p">,</span> <span class="n">windows</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]],</span>
                           <span class="n">stat_test</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">ks_2samp</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">input_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">replacement_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                           <span class="n">iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">replacements</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate the sensitivity of the residues that are significant on at least one iteration</span>
<span class="n">sensitivity</span> <span class="o">=</span> <span class="n">sensitivity_calc</span><span class="p">(</span><span class="n">significant_res_per_iter</span><span class="p">)</span>

<span class="c1"># Create a histogram of the most significant residues</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># Flatten the sets of significant residue to a single list</span>
<span class="n">flat_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">residue</span> <span class="k">for</span> <span class="n">iteration_residues</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">iteration_residues</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">flat_res</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">292</span><span class="p">))</span>    <span class="c1"># Hardcoded number of residues</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Residue Id&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Number of Appearances&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Histogram of Significant Residues on 1 - 500 OR 501 - 1000&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">291</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">292</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">110</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">291</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Number of Iterations&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Output:</strong></p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/rmsf_sign_hist.png"><img alt="rmsf hist of sign residues missing" src="../_images/rmsf_sign_hist.png" style="width: 550px; height: 400px;" /></a>
<p class="caption"><span class="caption-text">Histogram of significant residues from bootstrapped method</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<span class="target" id="module-MDSimsEval.rmsf_bootstrapped_analysis"></span><dl class="py function">
<dt id="MDSimsEval.rmsf_bootstrapped_analysis.bootstrapped_residue_analysis">
<code class="sig-prename descclassname">MDSimsEval.rmsf_bootstrapped_analysis.</code><code class="sig-name descname">bootstrapped_residue_analysis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">start</span></em>, <em class="sig-param"><span class="n">stop</span></em>, <em class="sig-param"><span class="n">stat_test</span></em>, <em class="sig-param"><span class="n">threshold</span></em>, <em class="sig-param"><span class="n">samples_numb</span></em>, <em class="sig-param"><span class="n">sample_size</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_bootstrapped_analysis.bootstrapped_residue_analysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate <code class="docutils literal notranslate"><span class="pre">samples_numb</span></code> random samples  that each one will have <code class="docutils literal notranslate"><span class="pre">sample_size</span></code> agonists and <code class="docutils literal notranslate"><span class="pre">sample_size</span></code>
antagonists. Then perform a statistical test on the RMSFs of each residue of the agonists vs the RMSFs of each
residue of the antagonists. If the difference is significant save the residue as important for the specific
iteration.</p>
<p>Finally, return the significant residues on each iteration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
<li><p><strong>stat_test</strong> (<em>scipy.stats</em>) – A statistical test method with the interface of scipy.stats methods</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – The p-value threshold of the accepted and returned residues</p></li>
<li><p><strong>samples_numb</strong> (<em>int</em>) – How many random samples will be generated</p></li>
<li><p><strong>sample_size</strong> (<em>int</em>) – How many ligands each sample will have of each class. Eg if <code class="docutils literal notranslate"><span class="pre">sample_size=10</span></code> then each
sample will have 10 agonists and 10 antagonists</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of <code class="docutils literal notranslate"><span class="pre">samples_numb</span></code> sets. Each sets contains the <code class="docutils literal notranslate"><span class="pre">ResidueId</span></code> of the residues that were significant on
the specific iteration</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_bootstrapped_analysis.create_correlation_df">
<code class="sig-prename descclassname">MDSimsEval.rmsf_bootstrapped_analysis.</code><code class="sig-name descname">create_correlation_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">residue_ids</span></em>, <em class="sig-param"><span class="n">method</span></em>, <em class="sig-param"><span class="n">start</span></em>, <em class="sig-param"><span class="n">stop</span></em>, <em class="sig-param"><span class="n">rmsf_cache</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_bootstrapped_analysis.create_correlation_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <code class="docutils literal notranslate"><span class="pre">numb_of_ligands</span> <span class="pre">x</span> <span class="pre">numb_of_ligands</span></code> dataframe which has the pair correlations calculated
on the rmsf of the given <code class="docutils literal notranslate"><span class="pre">residue_ids</span></code>.</p>
<p>The result is not in a readable format and could be passed in <code class="docutils literal notranslate"><span class="pre">MDSimsEval.utils.render_corr_df</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>residue_ids</strong> – List of residue ids that we want the correlation on</p></li>
<li><p><strong>the top-k</strong><strong>, </strong><strong>high-k</strong><strong>, </strong><strong>most statistically significant.</strong> (<em>Eg</em>) – </p></li>
<li><p><strong>method</strong> (<em>str</em>) – pearson, kendall, spearman</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
<li><p><strong>rmsf_cache</strong> – Dictionary with key <code class="docutils literal notranslate"><span class="pre">ligand_name_start_stop</span></code> and value the RMSF run result. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code> no
cache will be kept</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> which has the pair correlations of all the ligands</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_bootstrapped_analysis.find_rmsf_of_residues">
<code class="sig-prename descclassname">MDSimsEval.rmsf_bootstrapped_analysis.</code><code class="sig-name descname">find_rmsf_of_residues</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">analysis_actors_dict</span></em>, <em class="sig-param"><span class="n">which_residues</span></em>, <em class="sig-param"><span class="n">start</span></em>, <em class="sig-param"><span class="n">stop</span></em>, <em class="sig-param"><span class="n">rmsf_cache</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_bootstrapped_analysis.find_rmsf_of_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>This method finds and returns the RMSFs of each agonist and antagonist of the input residues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_actors_dict</strong> – <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;Agonists&quot;:</span> <span class="pre">List[AnalysisActor.class],</span> <span class="pre">&quot;Antagonists&quot;:</span> <span class="pre">List[AnalysisActor.class]</span> <span class="pre">}</span></code></p></li>
<li><p><strong>which_residues</strong> – List of residue ids that we will return their RMSF value</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
<li><p><strong>rmsf_cache</strong> – Dictionary with key <code class="docutils literal notranslate"><span class="pre">ligand_name_start_stop</span></code> and value the RMSF run result. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code> no
cache will be kept</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> of shape <code class="docutils literal notranslate"><span class="pre">numb_of_agonist</span> <span class="pre">+</span> <span class="pre">numb_of_antagonists,</span> <span class="pre">which_residues_length</span></code> containing the
RMSF of each ligand of the input residue ids</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_bootstrapped_analysis.initialize_pools">
<code class="sig-prename descclassname">MDSimsEval.rmsf_bootstrapped_analysis.</code><code class="sig-name descname">initialize_pools</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ligands_list</span></em>, <em class="sig-param"><span class="n">total_ligands</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">set_ligands</span><span class="o">=</span><span class="default_value">12</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_bootstrapped_analysis.initialize_pools" title="Permalink to this definition">¶</a></dt>
<dd><p>Inputs a list of <code class="docutils literal notranslate"><span class="pre">MDSimsEval.AnalysisActor</span></code> objects and returns initial input and replacement
sets of the given size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ligands_List</strong> – List of <code class="docutils literal notranslate"><span class="pre">MDSimsEval.AnalysisActor</span></code> objects</p></li>
<li><p><strong>total_ligands</strong> (<em>int</em>) – How many ligands will be used in the experiment (input + replacement sets sizes)</p></li>
<li><p><strong>set_ligands</strong> (<em>int</em>) – How many ligands will be on the initial input set. The rest of them will be on the</p></li>
<li><p><strong>set</strong> (<em>replacement</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><div class="line-block">
<div class="line">Tuple of (List of <code class="docutils literal notranslate"><span class="pre">MDSimsEval.AnalysisActor</span></code> that will be our initial input set,</div>
<div class="line-block">
<div class="line">List of <code class="docutils literal notranslate"><span class="pre">MDSimsEval.AnalysisActor</span></code> that will be our initial replacement set)</div>
</div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_bootstrapped_analysis.minimal_stat_test">
<code class="sig-prename descclassname">MDSimsEval.rmsf_bootstrapped_analysis.</code><code class="sig-name descname">minimal_stat_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">agonists</span></em>, <em class="sig-param"><span class="n">antagonists</span></em>, <em class="sig-param"><span class="n">stat_test</span></em>, <em class="sig-param"><span class="n">start</span></em>, <em class="sig-param"><span class="n">stop</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">cache</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_bootstrapped_analysis.minimal_stat_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Inputs a list of agonists and a list of antagonists and finds the most significant residues. We do not return
the p_value but only the residue ids.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>RMSF calculations are cached to avoid recalculating them. In order to use the caching mechanism we give as an
argument an empty dictionary <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>agonists</strong> – List of <code class="docutils literal notranslate"><span class="pre">MDSimsEval.AnalysisActor</span></code> agonists</p></li>
<li><p><strong>antagonists</strong> – List of <code class="docutils literal notranslate"><span class="pre">MDSimsEval.AnalysisActor</span></code> antagonists</p></li>
<li><p><strong>stat_test</strong> (<em>scipy.stats</em>) – A statistical test method with the interface of scipy.stats methods</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting frame of the calculations</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stopping frame of the calculations</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – The p-value threshold of the accepted and returned residues</p></li>
<li><p><strong>cache</strong> – Dictionary with key <code class="docutils literal notranslate"><span class="pre">ligand_name_start_stop</span></code> and value the RMSF run result. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code> no cache
will be kept</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_bootstrapped_analysis.plot_hists_summary">
<code class="sig-prename descclassname">MDSimsEval.rmsf_bootstrapped_analysis.</code><code class="sig-name descname">plot_hists_summary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bootstrapped_results</span></em>, <em class="sig-param"><span class="n">residue_numb</span></em>, <em class="sig-param"><span class="n">dir_path</span></em>, <em class="sig-param"><span class="n">top_k</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_bootstrapped_analysis.plot_hists_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a histogram which summarizes which residues were found significant and on how many samples on
each window. The colors go from black (1st window) to yellow (5th window). In case of a residue being important
on more than 1 window, the bars are stacked in chronological order (from the earlier windows to the later ones).
The height of the bars shows the number of samples the residue was statistically important.</p>
<p>On the legend the word <strong>thresh</strong> specifies the number of samples a residue must be found significant in, in order
to be included in the <code class="docutils literal notranslate"><span class="pre">top-k</span></code> most significant residues.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently the function expects five windows of 500 frames each (0 - 500, 500 - 1000, …, 2000 - 2500).</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">MDSimsEval.utils</span> <span class="kn">import</span> <span class="n">create_analysis_actor_dict</span>
<span class="kn">from</span> <span class="nn">MDSimsEval.rmsf_bootstrapped_analysis</span> <span class="kn">import</span> <span class="n">bootstrapped_residue_analysis</span>
<span class="kn">from</span> <span class="nn">MDSimsEval.rmsf_bootstrapped_analysis</span> <span class="kn">import</span> <span class="n">plot_hists_summary</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># Read the data</span>
<span class="n">analysis_actors_dict</span> <span class="o">=</span> <span class="n">create_analysis_actor_dict</span><span class="p">(</span><span class="s1">&#39;path_to_dataset_roor_folder&#39;</span><span class="p">)</span>

<span class="c1"># Do not use all the ligands so as to have a validation set</span>
<span class="n">agonists_train</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">analysis_actors_dict</span><span class="p">[</span><span class="s1">&#39;Agonists&#39;</span><span class="p">],</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">antagonists_train</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">analysis_actors_dict</span><span class="p">[</span><span class="s1">&#39;Antagonists&#39;</span><span class="p">],</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">bootstrapped_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">500</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">bootstrapped_residue_analysis</span><span class="p">({</span><span class="s2">&quot;Agonists&quot;</span><span class="p">:</span> <span class="n">agonists_train</span><span class="p">,</span> <span class="s2">&quot;Antagonists&quot;</span><span class="p">:</span> <span class="n">antagonists_train</span><span class="p">},</span>
                                        <span class="n">start</span><span class="p">,</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">500</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">ks_2samp</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">samples_numb</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                                        <span class="n">sample_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">bootstrapped_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="c1"># Here it is suggested to save the bootstrapped_results on disk using pickle so as to avoid</span>
<span class="c1"># recalculating them</span>

<span class="n">plot_hists_summary</span><span class="p">(</span><span class="n">bootstrapped_results</span><span class="p">,</span> <span class="n">residue_numb</span><span class="o">=</span><span class="mi">290</span><span class="p">,</span> <span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;path_to_save_dir/&#39;</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../_images/multi_color_hists_.png"><img alt="rmsf multi colored hists missing" src="../_images/multi_color_hists_.png" style="width: 700px; height: 200px;" /></a>
<p class="caption"><span class="caption-text">Output plot of the above script, click for higher resolution</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bootstrapped_results</strong> – A list of <cite>bootstrapped_residue_analysis</cite> results for each window</p></li>
<li><p><strong>residue_numb</strong> (<em>int</em>) – The total number of residues in the RMSF selection</p></li>
<li><p><strong>dir_path</strong> (<em>str</em>) – The path of the directory the plot will be saved (must end with a <code class="docutils literal notranslate"><span class="pre">/</span></code>)</p></li>
<li><p><strong>top_k</strong> (<em>int</em>) – How many residues to include in order of significance</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_bootstrapped_analysis.replacement_swap">
<code class="sig-prename descclassname">MDSimsEval.rmsf_bootstrapped_analysis.</code><code class="sig-name descname">replacement_swap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_set</span></em>, <em class="sig-param"><span class="n">replacement_set</span></em>, <em class="sig-param"><span class="n">numb_of_replacements</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_bootstrapped_analysis.replacement_swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs given number of swaps between the input_set and the replacement_set.The swaps are inplace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_set</strong> – List of <code class="docutils literal notranslate"><span class="pre">MDSimsEval.AnalysisActor</span></code> that is our input set</p></li>
<li><p><strong>replacement_set</strong> – List of <code class="docutils literal notranslate"><span class="pre">MDSimsEval.AnalysisActor</span></code> that is our replacement set</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="MDSimsEval.rmsf_bootstrapped_analysis.sensitivity_calc">
<code class="sig-prename descclassname">MDSimsEval.rmsf_bootstrapped_analysis.</code><code class="sig-name descname">sensitivity_calc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sign_residues_per_iter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#MDSimsEval.rmsf_bootstrapped_analysis.sensitivity_calc" title="Permalink to this definition">¶</a></dt>
<dd><div class="line-block">
<div class="line">Inputs the output of <code class="docutils literal notranslate"><span class="pre">bootstrapped_residue_analysis</span></code> and calculates the sensitivity of each residue.</div>
<div class="line">The returned sensitivity of each residue is calculated by calculating <code class="docutils literal notranslate"><span class="pre">residue_appearances</span> <span class="pre">/</span> <span class="pre">iterations</span></code>.</div>
<div class="line">A sensitivity of 1 is ideal meaning that the residue was significant to all the iterations.</div>
<div class="line"><br /></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sign_residues_per_iter</strong> – A list of sets containing the residue ids of the significant residues on each iteration</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary of <code class="docutils literal notranslate"><span class="pre">ResidueId(key),</span> <span class="pre">Sensitivity(value)</span></code> for all the residues that appeared at least on one
iteration</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="RMSFBaselineModels.html" class="btn btn-neutral float-right" title="6. RMSF Baseline Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="RgSasaAnalysis.html" class="btn btn-neutral float-left" title="4. Rg and SASA Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Mike Xydas

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>